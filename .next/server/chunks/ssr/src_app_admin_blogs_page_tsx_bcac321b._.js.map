{"version":3,"sources":["turbopack:///[project]/src/app/admin/blogs/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { useRole } from '@/hooks/useRole';\n\ninterface Blog {\n  id: string;\n  title: string;\n  slug: string;\n  tags: string[];\n  status: 'DRAFT' | 'PUBLISHED' | 'ARCHIVED';\n  createdAt: string;\n  updatedAt: string;\n  author: {\n    id: string;\n    name: string | null;\n    email: string;\n    imageUrl: string | null;\n  };\n  categories: {\n    category: {\n      id: string;\n      name: string;\n    };\n  }[];\n}\n\nexport default function BlogsPage() {\n  const [blogs, setBlogs] = useState<Blog[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const { isAdmin, isEditor, isAuthor } = useRole();\n\n  useEffect(() => {\n    fetchBlogs();\n  }, []);\n\n  const fetchBlogs = async () => {\n    try {\n      const response = await fetch('/api/blogs');\n      if (!response.ok) {\n        throw new Error('Failed to fetch blogs');\n      }\n      const data = await response.json();\n      setBlogs(data.blogs);\n    } catch (error) {\n      console.error('Error fetching blogs:', error);\n      setError('Failed to load blogs');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDelete = async (id: string, title: string) => {\n    if (!confirm(`Are you sure you want to delete the blog \"${title}\"?`)) {\n      return;\n    }\n\n    try {\n      const response = await fetch(`/api/blogs/${id}`, {\n        method: 'DELETE',\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error || 'Failed to delete blog');\n      }\n\n      setBlogs(blogs.filter(blog => blog.id !== id));\n    } catch (error) {\n      console.error('Error deleting blog:', error);\n      alert(error instanceof Error ? error.message : 'Failed to delete blog');\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'PUBLISHED':\n        return 'bg-green-100 text-green-800';\n      case 'DRAFT':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'ARCHIVED':\n        return 'bg-gray-100 text-gray-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  // Check if user has permission after all hooks are called\n  if (!isAdmin && !isEditor && !isAuthor) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">Access Denied</h1>\n          <p className=\"text-gray-600 mb-6\">You don't have permission to access this page.</p>\n          <Link\n            href=\"/\"\n            className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n          >\n            Go Home\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Loading blogs...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white shadow\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center py-6\">\n            <div>\n              <h1 className=\"text-3xl font-bold text-gray-900\">Blogs</h1>\n              <p className=\"mt-2 text-gray-600\">Manage your blog posts</p>\n            </div>\n            <Link\n              href=\"/admin/blogs/create\"\n              className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n              </svg>\n              Create Blog\n            </Link>\n          </div>\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {error && (\n          <div className=\"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded\">\n            {error}\n          </div>\n        )}\n\n        {blogs.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <svg className=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n            </svg>\n            <h3 className=\"mt-2 text-sm font-medium text-gray-900\">No blogs</h3>\n            <p className=\"mt-1 text-sm text-gray-500\">Get started by creating a new blog.</p>\n            <div className=\"mt-6\">\n              <Link\n                href=\"/admin/blogs/create\"\n                className=\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n              >\n                <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n                </svg>\n                Create Blog\n              </Link>\n            </div>\n          </div>\n        ) : (\n          <div className=\"bg-white shadow overflow-hidden sm:rounded-md\">\n            <ul className=\"divide-y divide-gray-200\">\n              {blogs.map((blog) => (\n                <li key={blog.id} className=\"px-6 py-4\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-center space-x-3\">\n                        <h3 className=\"text-lg font-medium text-gray-900 truncate\">\n                          {blog.title}\n                        </h3>\n                        <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getStatusColor(blog.status)}`}>\n                          {blog.status}\n                        </span>\n                      </div>\n                      <div className=\"mt-1 flex items-center space-x-4 text-sm text-gray-500\">\n                        <span className=\"font-mono\">{blog.slug}</span>\n                        <span>•</span>\n                        <span>By {blog.author.name || blog.author.email}</span>\n                        <span>•</span>\n                        <span>{new Date(blog.createdAt).toLocaleDateString()}</span>\n                      </div>\n                      <div className=\"mt-2 flex flex-wrap gap-2\">\n                        {blog.tags.map((tag, index) => (\n                          <span\n                            key={index}\n                            className=\"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800\"\n                          >\n                            {tag}\n                          </span>\n                        ))}\n                      </div>\n                      <div className=\"mt-2 flex flex-wrap gap-2\">\n                        {blog.categories.map((cat) => (\n                          <span\n                            key={cat.category.id}\n                            className=\"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-100 text-green-800\"\n                          >\n                            {cat.category.name}\n                          </span>\n                        ))}\n                      </div>\n                    </div>\n                    <div className=\"flex items-center space-x-2\">\n                      <Link\n                        href={`/admin/blogs/${blog.id}`}\n                        className=\"text-blue-600 hover:text-blue-900 text-sm font-medium\"\n                      >\n                        View\n                      </Link>\n                      <Link\n                        href={`/admin/blogs/${blog.id}/edit`}\n                        className=\"text-indigo-600 hover:text-indigo-900 text-sm font-medium\"\n                      >\n                        Edit\n                      </Link>\n                      <button\n                        onClick={() => handleDelete(blog.id, blog.title)}\n                        className=\"text-red-600 hover:text-red-900 text-sm font-medium\"\n                      >\n                        Delete\n                      </button>\n                    </div>\n                  </div>\n                </li>\n              ))}\n            </ul>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}