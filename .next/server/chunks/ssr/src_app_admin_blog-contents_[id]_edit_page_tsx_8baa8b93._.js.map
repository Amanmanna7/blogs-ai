{"version":3,"sources":["turbopack:///[project]/src/app/admin/blog-contents/[id]/edit/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, use } from 'react';\nimport { useRouter } from 'next/navigation';\nimport BlogContentForm from '@/components/BlogContentForm';\nimport { useRole } from '@/hooks/useRole';\n\ninterface BlogContent {\n  id: string;\n  name: string;\n  slug: string;\n  textContent: string;\n  createdAt: string;\n  updatedAt: string;\n  createdBy: {\n    id: string;\n    name: string | null;\n    email: string;\n    imageUrl: string | null;\n  };\n}\n\ninterface EditBlogPageProps {\n  params: Promise<{ id: string }>;\n}\n\nexport default function EditBlogPage({ params }: EditBlogPageProps) {\n  const resolvedParams = use(params);\n  const [blogContent, setBlogContent] = useState<BlogContent | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isSaving, setIsSaving] = useState(false);\n  const router = useRouter();\n  const { user, isAuthor, isEditor } = useRole();\n\n  useEffect(() => {\n    fetchBlogContent();\n  }, [resolvedParams.id]);\n\n  const fetchBlogContent = async () => {\n    try {\n      setLoading(true);\n      const response = await fetch(`/api/blog-content/${resolvedParams.id}`);\n      \n      if (!response.ok) {\n        if (response.status === 404) {\n          setError('Blog content not found');\n        } else if (response.status === 403) {\n          setError('You don\\'t have permission to edit this content');\n        } else {\n          setError('Failed to load blog content');\n        }\n        return;\n      }\n      \n      const data = await response.json();\n      setBlogContent(data.blogContent);\n    } catch (error) {\n      console.error('Error fetching blog content:', error);\n      setError('Failed to load blog content');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSave = async (data: { name: string; slug: string; content: string }) => {\n    setIsSaving(true);\n    try {\n      const response = await fetch(`/api/blog-content/${resolvedParams.id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ \n          name: data.name,\n          slug: data.slug,\n          textContent: data.content \n        }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error || 'Failed to update blog content');\n      }\n\n      router.push(`/admin/blog-contents/${resolvedParams.id}`);\n    } catch (error) {\n      console.error('Error updating blog content:', error);\n      throw error;\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n\n  // Check if user has permission to edit\n  const canEdit = blogContent && (isEditor || blogContent.createdBy.id === user?.id);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Loading blog content...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-red-600 mb-4\">Error</h1>\n          <p className=\"text-gray-600 mb-6\">{error}</p>\n          <button\n            onClick={() => router.push('/admin/blog-contents')}\n            className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n          >\n            Go Back\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  if (!blogContent) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">Blog Content Not Found</h1>\n          <p className=\"text-gray-600 mb-6\">The blog content you're looking for doesn't exist.</p>\n          <button\n            onClick={() => router.push('/admin/blog-contents')}\n            className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n          >\n            Go Back to Blog Contents\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  if (!canEdit) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">Access Denied</h1>\n          <p className=\"text-gray-600 mb-6\">You don't have permission to edit this blog content.</p>\n          <button\n            onClick={() => router.push(`/admin/blog-contents/${resolvedParams.id}`)}\n            className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n          >\n            View Content\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <BlogContentForm\n        initialContent={blogContent.textContent}\n        initialName={blogContent.name}\n        initialSlug={blogContent.slug}\n        onSave={handleSave}\n        isEditing={true}\n        contentId={blogContent.id}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}