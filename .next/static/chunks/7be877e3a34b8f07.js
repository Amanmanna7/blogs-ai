(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,20500,e=>{"use strict";e.s(["default",()=>l]);var t=e.i(43476),s=e.i(62097);function l(e){let{title:l,tags:r,categories:a,sequences:n}=e,i=n.filter(e=>e.blogContentId||e.blogMediaId).sort((e,t)=>e.sequence-t.sequence);return(0,t.jsx)("div",{className:"p-1 lg:p-6",children:(0,t.jsxs)("div",{className:"prose max-w-none",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:l||"Untitled Blog"}),(0,t.jsx)("br",{}),i.length>0?i.map((e,l)=>{var r;return(0,t.jsxs)("div",{children:[e.blogContentId&&(0,t.jsx)("div",{children:(0,t.jsx)(s.default,{content:(null==(r=e.blogContent)?void 0:r.textContent)||""})}),e.blogMediaId&&e.blogMedia&&(0,t.jsx)("div",{children:(()=>{let s=e.blogMedia;if(!s)return null;switch(s.mediaType){case"IMAGE":return(0,t.jsxs)("div",{className:"my-4",children:[(0,t.jsx)("img",{src:s.mediaUrl,alt:s.name,className:"max-w-full h-auto rounded-lg shadow-md"}),s.description&&(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-2 italic text-center",children:s.description})]});case"VIDEO":return(0,t.jsxs)("div",{className:"my-4",children:[(0,t.jsx)("video",{src:s.mediaUrl,controls:!0,className:"max-w-full h-auto rounded-lg shadow-md",children:"Your browser does not support the video tag."}),s.description&&(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-2 italic text-center",children:s.description})]});case"AUDIO":return(0,t.jsxs)("div",{className:"my-4",children:[(0,t.jsx)("audio",{src:s.mediaUrl,controls:!0,className:"w-full",children:"Your browser does not support the audio tag."}),s.description&&(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-2 italic text-center",children:s.description})]});default:return(0,t.jsxs)("div",{className:"my-4 p-4 bg-gray-100 rounded-lg",children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,t.jsx)("strong",{children:s.name})," (",s.mediaType,")"]}),s.description&&(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-2 italic text-center",children:s.description}),(0,t.jsx)("a",{href:s.mediaUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm",children:"View/Download"})]})}})()})]},e.id)}):(0,t.jsx)("div",{className:"text-gray-500 italic",children:"No content or media added yet. Add some content or media to see the preview."}),(r.length>0||a.length>0)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("hr",{className:"my-8 border-gray-300"}),(0,t.jsxs)("div",{className:"space-y-4",children:[r.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Tags"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:r.map((e,s)=>(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e},s))})]}),a.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Categories"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:a.map(e=>(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:e.name},e.id))})]})]})]})]})})}},30009,e=>{"use strict";e.s(["default",()=>l]);var t=e.i(43476),s=e.i(71645);function l(e){let{options:l,value:r,onChange:a,placeholder:n="Search and select...",disabled:i=!1,className:d=""}=e,[o,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)(""),[x,g]=(0,s.useState)(l),b=(0,s.useRef)(null),h=(0,s.useRef)(null);(0,s.useEffect)(()=>{""===u.trim()?g(l):g(l.filter(e=>e.label.toLowerCase().includes(u.toLowerCase())))},[u,l]),(0,s.useEffect)(()=>{let e=e=>{b.current&&!b.current.contains(e.target)&&(c(!1),m(""))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,s.useEffect)(()=>{o&&h.current&&h.current.focus()},[o]);let f=l.find(e=>e.value===r),p=e=>{a(e),c(!1),m("")};return(0,t.jsxs)("div",{ref:b,className:"relative ".concat(d),children:[(0,t.jsx)("button",{type:"button",onClick:()=>{!i&&(c(!o),o||m(""))},disabled:i,className:"w-full px-3 py-2 text-left border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ".concat(i?"bg-gray-100 cursor-not-allowed":"bg-white cursor-pointer hover:border-gray-400"),children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:f?"text-gray-900":"text-gray-500",children:f?f.label:n}),(0,t.jsx)("svg",{className:"w-5 h-5 text-gray-400 transition-transform ".concat(o?"transform rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),o&&(0,t.jsxs)("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-hidden",children:[(0,t.jsx)("div",{className:"p-2 border-b border-gray-200",children:(0,t.jsx)("input",{ref:h,type:"text",value:u,onChange:e=>m(e.target.value),placeholder:"Search...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onClick:e=>e.stopPropagation()})}),(0,t.jsx)("div",{className:"max-h-48 overflow-y-auto",children:0===x.length?(0,t.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500 text-center",children:"No options found"}):(0,t.jsxs)(t.Fragment,{children:[r&&(0,t.jsx)("button",{type:"button",onClick:()=>p(""),className:"w-full px-3 py-2 text-left text-sm text-gray-500 hover:bg-gray-50 focus:bg-gray-50 focus:outline-none border-b border-gray-200",children:"Clear selection"}),x.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>p(e.value),className:"w-full px-3 py-2 text-left text-sm hover:bg-blue-50 focus:bg-blue-50 focus:outline-none ".concat(r===e.value?"bg-blue-100 font-medium":"text-gray-900"),children:e.label},e.value))]})})]})]})}},54928,e=>{"use strict";e.s(["default",()=>d],54928);var t=e.i(43476),s=e.i(71645),l=e.i(18566),r=e.i(68513),a=e.i(20500),n=e.i(30009);function i(e){var l;let{sequence:r,index:a,blogContents:i,blogMedia:d,onUpdate:o,onRemove:c,onMove:u,disabled:m=!1}=e,[x,g]=(0,s.useState)(!1),b=r.type;return(0,t.jsxs)("div",{draggable:!m,onDragStart:e=>{m||(g(!0),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",a.toString()),e.dataTransfer.setData("application/json",JSON.stringify({index:a,sequenceId:r.id})))},onDragEnd:()=>{g(!1)},onDragOver:e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},onDrop:e=>{if(e.preventDefault(),!m)try{let t=parseInt(e.dataTransfer.getData("text/plain"));isNaN(t)||t===a||u(t,a)}catch(e){console.error("Error handling drop:",e)}},className:"p-4 border-2 border-dashed rounded-lg transition-all duration-200 ".concat(x?"border-blue-500 bg-blue-50 shadow-lg transform rotate-2 scale-105":"border-gray-300 hover:border-gray-400 hover:shadow-md"," ").concat(m?"opacity-50 cursor-not-allowed":"cursor-move hover:bg-gray-50"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm font-medium text-gray-600",children:r.sequence}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"content"===b?"Content":"Media"})]}),!m&&(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"text-gray-400 text-xs",children:"Drag to reorder"}),(0,t.jsx)("div",{className:"text-gray-400",children:"â‹®â‹®"})]}),(0,t.jsx)("button",{type:"button",onClick:()=>c(r.id),className:"text-red-500 hover:text-red-700 text-sm",disabled:m,children:"Remove"})]}),"content"===b?(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Content"}),(0,t.jsx)(n.default,{options:i.map(e=>({value:e.id,label:e.name})),value:r.blogContentId||"",onChange:e=>{o(r.id,{blogContentId:e||void 0,type:"content"})},placeholder:"Choose content...",disabled:m,className:"w-full"}),r.blogContentId&&(0,t.jsx)("div",{className:"mt-2 p-2 bg-gray-50 rounded text-sm text-gray-600",children:null==(l=i.find(e=>e.id===r.blogContentId))?void 0:l.name})]}):(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Media"}),(0,t.jsxs)("select",{value:r.blogMediaId||"",onChange:e=>{var t;return t=e.target.value,void o(r.id,{blogMediaId:t,type:"media"})},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:m,children:[(0,t.jsx)("option",{value:"",children:"Choose media..."}),d.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," (",e.mediaType,")"]},e.id))]}),r.blogMediaId&&(0,t.jsx)("div",{className:"mt-2",children:(()=>{let e=d.find(e=>e.id===r.blogMediaId);return e?(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 bg-white",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,t.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:e.mediaType})]}),(0,t.jsxs)("div",{className:"mt-3",children:["IMAGE"===e.mediaType?(0,t.jsx)("img",{src:e.mediaUrl,alt:e.name,className:"max-w-full max-h-48 object-contain rounded border",onError:e=>{var t;e.currentTarget.style.display="none",null==(t=e.currentTarget.nextElementSibling)||t.classList.remove("hidden")}}):"VIDEO"===e.mediaType?(0,t.jsx)("video",{src:e.mediaUrl,controls:!0,className:"max-w-full max-h-48 rounded border",onError:e=>{var t;e.currentTarget.style.display="none",null==(t=e.currentTarget.nextElementSibling)||t.classList.remove("hidden")}}):"AUDIO"===e.mediaType?(0,t.jsx)("audio",{src:e.mediaUrl,controls:!0,className:"w-full",onError:e=>{var t;e.currentTarget.style.display="none",null==(t=e.currentTarget.nextElementSibling)||t.classList.remove("hidden")}}):(0,t.jsx)("div",{className:"flex items-center justify-center p-8 bg-gray-50 rounded border",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"ðŸ“„"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[e.mediaType," File"]}),(0,t.jsx)("a",{href:e.mediaUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm mt-1 inline-block",children:"View File"})]})}),(0,t.jsx)("div",{className:"hidden items-center justify-center p-8 bg-gray-50 rounded border",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"âš ï¸"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Media preview unavailable"}),(0,t.jsx)("a",{href:e.mediaUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm mt-1 inline-block",children:"Open in new tab"})]})})]}),e.description&&(0,t.jsx)("div",{className:"mt-3 text-center",children:(0,t.jsx)("p",{className:"text-sm text-gray-500 italic",children:e.description})}),(0,t.jsx)("div",{className:"mt-2 text-xs text-gray-500 break-all",children:e.mediaUrl})]}):null})()})]})]})}function d(e){let{initialData:n,isEditing:d=!1}=e,[o,c]=(0,s.useState)((null==n?void 0:n.title)||""),[u,m]=(0,s.useState)((null==n?void 0:n.slug)||""),[x,g]=(0,s.useState)((null==n?void 0:n.tags)||[]),[b,h]=(0,s.useState)((null==n?void 0:n.status)||"DRAFT"),[f,p]=(0,s.useState)((null==n?void 0:n.readingTime)||5),[v,y]=(0,s.useState)(()=>{var e;return(null==n||null==(e=n.categories)?void 0:e.map(e=>e.id))||[]}),[j,N]=(0,s.useState)((null==n?void 0:n.sequences)||[]),[w,C]=(0,s.useState)(""),[I,S]=(0,s.useState)(!1),[E,T]=(0,s.useState)(""),[k,M]=(0,s.useState)([]),[q,D]=(0,s.useState)([]),[U,L]=(0,s.useState)([]),[A,F]=(0,s.useState)(!0),[R,B]=(0,s.useState)(50),O=(0,l.useRouter)(),{user:P}=(0,r.useRole)();(0,s.useEffect)(()=>{V()},[]),(0,s.useEffect)(()=>{d&&(null==n?void 0:n.sequences)&&q.length>0&&U.length>0&&N(n.sequences.map(e=>{let t={...e};if(e.blogContentId){let s=q.find(t=>t.id===e.blogContentId);s&&(t.blogContent=s,t.type="content")}if(e.blogMediaId){let s=U.find(t=>t.id===e.blogMediaId);s&&(t.blogMedia=s,t.type="media")}return t}))},[d,null==n?void 0:n.sequences,q,U]),(0,s.useEffect)(()=>{d&&(null==n?void 0:n.categories)&&k.length>0&&y(n.categories.map(e=>e.id))},[d,null==n?void 0:n.categories,k]);let V=async()=>{try{let[e,t,s]=await Promise.all([fetch("/api/categories"),fetch("/api/blog-content"),fetch("/api/blog-media")]),[l,r,a]=await Promise.all([e.json(),t.json(),s.json()]);M(l.categories||[]),D(r.blogContents||[]),L(a.data||[])}catch(e){console.error("Error fetching data:",e)}finally{F(!1)}},z=e=>e.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),K=(e,t)=>{N(j.map(s=>{if(s.id===e){let e={...s,...t};if("content"===t.type?(e.blogMediaId=void 0,e.blogMedia=void 0):"media"===t.type&&(e.blogContentId=void 0,e.blogContent=void 0),t.blogContentId&&"content"===t.type){let s=q.find(e=>e.id===t.blogContentId);s&&(e.blogContent=s)}if(t.blogMediaId&&"media"===t.type){let s=U.find(e=>e.id===t.blogMediaId);s&&(e.blogMedia=s)}return e}return s}))},Y=e=>{N(j.filter(t=>t.id!==e).sort((e,t)=>e.sequence-t.sequence).map((e,t)=>({...e,sequence:t+1})))},_=(e,t)=>{if(e===t)return;if(e<0||e>=j.length||t<0||t>=j.length)return void console.error("Invalid drag indices:",{dragIndex:e,hoverIndex:t,length:j.length});let s=j[e],l=[...j];l.splice(e,1),l.splice(t,0,s),N(l.map((e,t)=>({...e,sequence:t+1})))},G=async e=>{e.preventDefault(),S(!0),T("");try{let e=d?"/api/blogs/".concat(null==n?void 0:n.id):"/api/blogs",t=d?"PUT":"POST",s=await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify({title:o,slug:u,tags:x,status:b,readingTime:f,authorId:null==P?void 0:P.id,categoryIds:v,sequences:j.map(e=>({sequence:e.sequence,type:e.type,blogContentId:e.blogContentId,blogMediaId:e.blogMediaId}))})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to save blog")}await s.json(),O.push("/admin/blogs")}catch(e){console.error("Error saving blog:",e),T(e instanceof Error?e.message:"Failed to save blog")}finally{S(!1)}};return A?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):d&&(null==n?void 0:n.sequences)&&0===j.length?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading blog sequences..."})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsxs)("div",{className:"flex h-screen",children:[(0,t.jsx)("div",{className:"bg-white shadow-lg overflow-y-auto",style:{width:"".concat(100-R,"%")},children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:d?"Edit Blog":"Create New Blog"}),(0,t.jsxs)("form",{onSubmit:G,className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),(0,t.jsx)("input",{type:"text",id:"title",value:o,onChange:e=>{let t=e.target.value;c(t),d&&u!==z((null==n?void 0:n.title)||"")||m(z(t))},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter blog title",required:!0,disabled:I})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"slug",className:"block text-sm font-medium text-gray-700 mb-2",children:"Slug *"}),(0,t.jsx)("input",{type:"text",id:"slug",value:u,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"blog-slug",required:!0,disabled:I})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:x.map((e,s)=>(0,t.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[e,(0,t.jsx)("button",{type:"button",onClick:()=>{g(x.filter(t=>t!==e))},className:"ml-2 text-blue-600 hover:text-blue-800",children:"Ã—"})]},s))}),(0,t.jsx)("input",{type:"text",value:w,onChange:e=>C(e.target.value),onKeyDown:e=>{"Enter"===e.key&&w.trim()&&(e.preventDefault(),x.includes(w.trim())||g([...x,w.trim()]),C(""))},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Add tags (press Enter to add)",disabled:I})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,t.jsxs)("select",{id:"status",value:b,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:I,children:[(0,t.jsx)("option",{value:"DRAFT",children:"Draft"}),(0,t.jsx)("option",{value:"PUBLISHED",children:"Published"}),(0,t.jsx)("option",{value:"ARCHIVED",children:"Archived"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"readingTime",className:"block text-sm font-medium text-gray-700 mb-2",children:"Reading Time (minutes)"}),(0,t.jsx)("input",{type:"number",id:"readingTime",min:"1",max:"120",value:f,onChange:e=>p(parseInt(e.target.value)||5),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"5",disabled:I}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Estimated reading time in minutes (1-120)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categories"}),(0,t.jsx)("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-300 rounded-md p-2",children:k.map(e=>{let s=v.includes(e.id);return(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:s,onChange:t=>{t.target.checked?y([...v,e.id]):y(v.filter(t=>t!==e.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",disabled:I}),(0,t.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:e.name})]},e.id)})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Content Sequence"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{let e=Math.max(...j.map(e=>e.sequence),0)+1;N([...j,{id:"temp-".concat(Date.now()),sequence:e,type:"content",blogContentId:void 0}])},className:"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700",disabled:I,children:"+ Add Content"}),(0,t.jsx)("button",{type:"button",onClick:()=>{let e=Math.max(...j.map(e=>e.sequence),0)+1;N([...j,{id:"temp-".concat(Date.now()),sequence:e,type:"media",blogMediaId:void 0}])},className:"px-3 py-1 text-sm bg-purple-600 text-white rounded hover:bg-purple-700",disabled:I,children:"+ Add Media"})]})]}),(0,t.jsx)("div",{className:"space-y-3",children:j.sort((e,t)=>e.sequence-t.sequence).map((e,s)=>(0,t.jsx)(i,{sequence:e,index:s,blogContents:q,blogMedia:U,onUpdate:K,onRemove:Y,onMove:_,disabled:I},e.id))})]}),E&&(0,t.jsx)("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-md",children:E}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)("button",{type:"submit",disabled:I||!o.trim()||!u.trim(),className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:I?"Saving...":d?"Update Blog":"Create Blog"}),(0,t.jsx)("button",{type:"button",onClick:()=>O.push("/admin/blogs"),className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors",disabled:I,children:"Cancel"})]})]})]})}),(0,t.jsx)("div",{className:"w-2 bg-gray-300 hover:bg-gray-400 cursor-col-resize flex items-center justify-center",onMouseDown:e=>{let t=e.clientX,s=e=>{B(Math.max(20,Math.min(80,R-(e.clientX-t)/window.innerWidth*100)))},l=()=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",l)},children:(0,t.jsx)("div",{className:"w-1 h-8 bg-gray-500 rounded"})}),(0,t.jsx)("div",{className:"bg-gray-100 overflow-y-auto",style:{width:"".concat(R,"%")},children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Preview"}),(0,t.jsx)(a.default,{title:o,tags:x,categories:k.filter(e=>v.includes(e.id)),sequences:j})]})})]})})}},31387,e=>{"use strict";e.s(["default",()=>a]);var t=e.i(43476),s=e.i(71645),l=e.i(68513),r=e.i(54928);function a(e){let{params:a}=e,[n,i]=(0,s.useState)(null),[d,o]=(0,s.useState)(!0),[c,u]=(0,s.useState)(""),{isAdmin:m,isEditor:x,isAuthor:g}=(0,l.useRole)();return((0,s.useEffect)(()=>{(async()=>{try{let e=await a,t=await fetch("/api/blogs/".concat(e.id));if(!t.ok)return void(404===t.status?u("Blog not found"):u("Failed to load blog"));let s=await t.json(),l={...s.blog,categories:s.blog.categories.map(e=>({id:e.category.id,name:e.category.name}))};i(l)}catch(e){console.error("Error fetching blog:",e),u("Failed to load blog")}finally{o(!1)}})()},[a]),m||x||g)?d?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading blog..."})]})}):c?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:c})]})}):n?(0,t.jsx)(r.default,{initialData:n,isEditing:!0}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Blog Not Found"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"The blog you're looking for doesn't exist."})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"You don't have permission to edit blogs."})]})})}}]);