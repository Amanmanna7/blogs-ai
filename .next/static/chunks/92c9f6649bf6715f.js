(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,11285,e=>{"use strict";e.s(["default",()=>n]);var s=e.i(43476),t=e.i(71645),r=e.i(18566),a=e.i(22016),l=e.i(68513);function n(e){let{params:n}=e,i=(0,r.useRouter)(),{isAdmin:d,isEditor:o,isAuthor:c}=(0,l.useRole)(),[u,m]=(0,t.useState)(!0),[x,h]=(0,t.useState)(!1),[p,g]=(0,t.useState)(""),[b,f]=(0,t.useState)(null),{id:j}=(0,t.use)(n),[y,v]=(0,t.useState)({name:"",description:"",price_per_month:0,status:"ACTIVE"}),[N,w]=(0,t.useState)([]),[C,k]=(0,t.useState)({feature:"",description:"",featureSlug:"",status:"ACTIVE"}),S=e=>e.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),A=async()=>{try{let e=await fetch("/api/plans/".concat(j));if(!e.ok)throw Error("Failed to fetch plan");let s=await e.json();f(s.plan),v({name:s.plan.name,description:s.plan.description,price_per_month:s.plan.price_per_month,status:s.plan.status}),w(s.plan.features)}catch(e){console.error("Error fetching plan:",e),g("Failed to load plan")}finally{m(!1)}},E=async e=>{e.preventDefault(),h(!0),g("");try{let e=await fetch("/api/plans/".concat(j),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...y,features:N})});if(!e.ok){let s=await e.json();throw Error(s.error||"Failed to update plan")}i.push("/admin/plans")}catch(e){console.error("Error updating plan:",e),g(e instanceof Error?e.message:"Failed to update plan")}finally{h(!1)}};return((0,t.useEffect)(()=>{A()},[j]),d||o||c)?u?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading plan..."})]})}):b?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"bg-white shadow",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("nav",{className:"flex","aria-label":"Breadcrumb",children:(0,s.jsxs)("ol",{className:"flex items-center space-x-4",children:[(0,s.jsx)("li",{children:(0,s.jsxs)(a.default,{href:"/admin",className:"text-gray-400 hover:text-gray-500",children:[(0,s.jsx)("svg",{className:"flex-shrink-0 h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"})}),(0,s.jsx)("span",{className:"sr-only",children:"Home"})]})}),(0,s.jsx)("li",{children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{className:"flex-shrink-0 h-5 w-5 text-gray-300",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{d:"M5.555 17.776l8-16 .894.448-8 16-.894-.448z"})}),(0,s.jsx)(a.default,{href:"/admin/plans",className:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700",children:"Plans"})]})}),(0,s.jsx)("li",{children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{className:"flex-shrink-0 h-5 w-5 text-gray-300",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{d:"M5.555 17.776l8-16 .894.448-8 16-.894-.448z"})}),(0,s.jsx)("span",{className:"ml-4 text-sm font-medium text-gray-500",children:"Edit Plan"})]})})]})}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mt-4",children:"Edit Plan"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"Update plan details and features"})]}),(0,s.jsxs)(a.default,{href:"/admin/plans",className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Plans"]})]})})}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Plan Details"}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:"Basic information about the subscription plan"})]}),(0,s.jsxs)("form",{onSubmit:E,className:"p-6 space-y-6",children:[p&&(0,s.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:(0,s.jsx)("span",{className:"block sm:inline",children:p})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Plan Name *"}),(0,s.jsx)("input",{type:"text",id:"name",value:y.name,onChange:e=>v({...y,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter plan name",required:!0,disabled:x})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,s.jsx)("textarea",{id:"description",value:y.description,onChange:e=>v({...y,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter plan description",rows:4,required:!0,disabled:x})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"price_per_month",className:"block text-sm font-medium text-gray-700 mb-2",children:"Price per Month (â‚¹) *"}),(0,s.jsx)("input",{type:"number",id:"price_per_month",min:"0",step:"0.01",value:y.price_per_month,onChange:e=>v({...y,price_per_month:parseFloat(e.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00",required:!0,disabled:x})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-2",children:"Status *"}),(0,s.jsxs)("select",{id:"status",value:y.status,onChange:e=>v({...y,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:x,children:[(0,s.jsx)("option",{value:"ACTIVE",children:"Active"}),(0,s.jsx)("option",{value:"INACTIVE",children:"Inactive"})]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Status Information"}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Active:"})," Plan is available for subscription"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Inactive:"})," Plan is not available for new subscriptions"]})]})]}),(0,s.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Plan Features"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:"Manage features that are included in this plan"}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[(0,s.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Add New Feature"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Feature Name *"}),(0,s.jsx)("input",{type:"text",value:C.feature,onChange:e=>{let s=e.target.value;k({...C,feature:s,featureSlug:S(s)})},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Unlimited Access, Priority Support",disabled:x})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Feature Slug *"}),(0,s.jsx)("input",{type:"text",value:C.featureSlug,onChange:e=>k({...C,featureSlug:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., unlimited-access, priority-support",disabled:x})]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,s.jsx)("textarea",{value:C.description,onChange:e=>k({...C,description:e.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describe what this feature provides...",disabled:x})]}),(0,s.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,s.jsxs)("select",{value:C.status,onChange:e=>k({...C,status:e.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:x,children:[(0,s.jsx)("option",{value:"ACTIVE",children:"Active"}),(0,s.jsx)("option",{value:"INACTIVE",children:"Inactive"}),(0,s.jsx)("option",{value:"ARCHIVED",children:"Archived"})]})]}),(0,s.jsxs)("button",{type:"button",onClick:()=>{if(!C.feature.trim()||!C.description.trim())return void alert("Please fill in feature name and description");let e=C.featureSlug.trim()||S(C.feature);return N.some(e=>e.feature.toLowerCase()===C.feature.toLowerCase())?void alert("A feature with this name already exists"):N.some(s=>s.featureSlug===e)?void alert("A feature with this slug already exists"):void(w([...N,{...C,featureSlug:e}]),k({feature:"",description:"",featureSlug:"",status:"ACTIVE"}))},disabled:x,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Feature"]})]})]}),0===N.length?(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,s.jsx)("p",{className:"mt-2",children:"No features added yet"}),(0,s.jsx)("p",{className:"text-sm",children:"Add features using the form above"})]}):(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("h4",{className:"text-md font-medium text-gray-900",children:["Current Features (",N.length,")"]}),N.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("h5",{className:"text-sm font-medium text-gray-900",children:e.feature}),(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ".concat("ACTIVE"===e.status?"bg-green-100 text-green-800":"INACTIVE"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Slug: ",e.featureSlug]})]}),(0,s.jsx)("button",{type:"button",onClick:()=>{w(N.filter((e,s)=>s!==t))},disabled:x,className:"text-red-600 hover:text-red-900 text-sm font-medium ml-4 disabled:opacity-50 disabled:cursor-not-allowed",children:"Remove"})]},t))]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[(0,s.jsx)("button",{type:"button",onClick:()=>i.back(),className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",disabled:x,children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:!y.name.trim()||!y.description.trim()||x,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:x?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Updating..."]}):(0,s.jsx)(s.Fragment,{children:"Update Plan"})})]})]})]})})]}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Plan Not Found"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"The plan you're looking for doesn't exist."}),(0,s.jsx)(a.default,{href:"/admin/plans",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Back to Plans"})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"You don't have permission to access this page."}),(0,s.jsx)(a.default,{href:"/",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Go Home"})]})})}}]);